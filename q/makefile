#
# makefile of q tools
#
# to make program object, type: make
# to make panel groups and CL commands, type: make uim_cmd
# to 
#

MAKER=LSBIN/RGMAKE
HOST=i810
RP=/home/ljl/chqs/i5tool/q
HOSTCMD=rexec $(HOST)
BINLIB=I5TOOLKIT

all: check-source upload compile
	echo "end of compilation :o:"

check-source:
	bash check-tab.sh *.mi

upload:
	ls *mi qmakefile | env WN_REMOTE_PATH=$(RP) WN_HOST=$(HOST) wn

compile:
	$(HOSTCMD) "CALL PGM($(MAKER)) PARM(X'00037F' '$(BINLIB)' '$(RP)' '')"

clean:
	$(HOSTCMD) "CALL PGM($(MAKER)) PARM(X'00037F' '$(BINLIB)' '$(RP)' 'clean')"

uim_cmd:
	$(HOSTCMD) "CRTPNLGRP PNLGRP(I5TOOLKIT/DSPQATHLP) SRCFILE(LS2008/DEC) SRCMBR(*PNLGRP) INCFILE(*SRCFILE) REPLACE(*YES)"
	$(HOSTCMD) "CRTPNLGRP PNLGRP(I5TOOLKIT/DSPQAT) SRCFILE(LS2008/DEC) SRCMBR(*PNLGRP) INCFILE(*SRCFILE) REPLACE(*YES)"
	$(HOSTCMD) "CRTPNLGRP PNLGRP(I5TOOLKIT/DSPQM) SRCFILE(LS2008/DEC) SRCMBR(*PNLGRP) INCFILE(*SRCFILE) REPLACE(*YES)"
	$(HOSTCMD) "CRTCMD CMD(I5TOOLKIT/DSPQD) PGM(*LIBL/QATTR) SRCFILE(LS2008/DEC) SRCMBR(*CMD) MODE(*ALL) ALLOW(*ALL) HLPPNLGRP(*LIBL/DSPQATHLP) HLPID('HELP/ABT')"
	$(HOSTCMD) "CRTCMD CMD(I5TOOLKIT/DSPQMSG) PGM(*LIBL/QMSG) SRCFILE(LS2008/DEC) SRCMBR(*CMD) MODE(*ALL) ALLOW(*ALL) HLPPNLGRP(*LIBL/DSPQATHLP) HLPID('HELP/ABTQM')"
	$(HOSTCMD) "CRTCMD CMD(I5TOOLKIT/CLRUSRQ) PGM(*LIBL/CLRUSRQ) SRCFILE(LS2008/DEC) SRCMBR(*CMD) MODE(*ALL) ALLOW(*ALL) HLPPNLGRP(*LIBL/DSPQATHLP) HLPID('HLP/CLQ')"
	$(HOSTCMD) "CRTCMD CMD(I5TOOLKIT/ENQUSRQ) PGM(*LIBL/ENQUSRQ) SRCFILE(LS2008/DEC) SRCMBR(*CMD) MODE(*ALL) ALLOW(*ALL) HLPPNLGRP(*LIBL/DSPQATHLP) HLPID('HLP/ENQ')"

pkg:
	$(HOSTCMD) "STRQSH CMD('chown -R QDFTOWN /qsys.lib/i5toolkit.lib')"
	@echo "Now, save library $(BINLIB) and download it."
